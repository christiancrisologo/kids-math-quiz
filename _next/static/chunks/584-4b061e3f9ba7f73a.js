"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{1396:(e,t,r)=>{r.d(t,{Ey:()=>o,UD:()=>a,Xy:()=>s,at:()=>c,g3:()=>u,gY:()=>l,mF:()=>i});var n=r(6429);function s(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="easy"===e?[2,8]:"medium"===e?[2,12]:[2,20],s=Math.floor(Math.random()*(r[1]-r[0]+1))+r[0];if(t){let t=Math.floor(Math.random()*("easy"===e?2*s:"medium"===e?3*s:4*s))+1;return new n.A(t,s)}{let e=Math.floor(Math.random()*(s-1))+1;return new n.A(e,s)}}let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=Math.floor(Math.random()*e)+2,r=Math.floor(Math.random()*(t-1))+1;return new n.A(r,t)},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=Math.floor(Math.random()*t)+2,s=r+Math.floor(Math.random()*e);return new n.A(s,r)},o=e=>{let t=Number(e.n),r=Number(e.d);if(1===r)return t.toString();if(Math.abs(t)<r)return"".concat(t,"/").concat(r);let n=Math.floor(Math.abs(t)/r),s=Math.abs(t)%r,i=t<0?"-":"";return 0===s?"".concat(i).concat(n):"".concat(i).concat(n," ").concat(s,"/").concat(r)},c=e=>{try{let t=e.trim();if(/^\d+$/.test(t))return new n.A(parseInt(t));if(/^\d+\/\d+$/.test(t))return new n.A(t);let r=t.match(/^(\d+)\s+(\d+)\/(\d+)$/);if(r){let e=parseInt(r[1]),t=parseInt(r[2]),s=parseInt(r[3]);return new n.A(e).add(new n.A(t,s))}let s=t.match(/^-(\d+)\s+(\d+)\/(\d+)$/);if(s){let e=parseInt(s[1]),t=parseInt(s[2]),r=parseInt(s[3]);return new n.A(e).add(new n.A(t,r)).mul(-1)}return null}catch(e){return null}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=new Set([o(e)]);for(;r.size<t;){let t,i=Math.random();if(i<.3){let r=.5>Math.random()?1:-1,s=Number(e.n),i=Number(e.d);t=new n.A(s+r,i)}else if(i<.6){let r=.5>Math.random()?1:-1,s=Number(e.n),i=Number(e.d);t=new n.A(s,Math.max(1,i+r))}else t=s("medium",!0);t.compare(0)>0&&!t.equals(e)&&r.add(o(t))}return Array.from(r).sort(()=>Math.random()-.5)},u=(e,t)=>{let r=c(e),n=c(t);return!!r&&!!n&&r.equals(n)}},2056:(e,t,r)=>{r.d(t,{O:()=>s,b:()=>n});let n={save:e=>{try{localStorage.setItem("mathquiz_user_preferences",JSON.stringify({...e,lastUpdated:new Date().toISOString()})),localStorage.setItem("mathquiz_user_info",JSON.stringify({userId:e.userId,userName:e.userName}))}catch(e){console.error("Failed to save user preferences:",e)}},load:()=>{try{let e=localStorage.getItem("mathquiz_user_preferences");if(!e)return null;let t=JSON.parse(e),r=localStorage.getItem("mathquiz_user_info"),n="",s="";if(r){let e=JSON.parse(r);n=e.userId,s=e.userName}return{...t,userId:n,userName:s,lastUpdated:new Date(t.lastUpdated)}}catch(e){return console.error("Failed to load user preferences:",e),null}},clear:()=>{try{localStorage.removeItem("mathquiz_user_preferences")}catch(e){console.error("Failed to clear user preferences:",e)}}},s={save:(e,t)=>{try{let r=localStorage.getItem("mathquiz_user_info"),n="";r&&(n=JSON.parse(r).userId);let i=new Date,a={...e,userId:n,id:"game_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),completedAt:i,created_at:i.toISOString(),pendingSync:!t},o=s.loadAll(),c=[a,...o].slice(0,100);return localStorage.setItem("mathquiz_game_history",JSON.stringify(c)),a}catch(e){throw console.error("Failed to save game result:",e),e}},syncPendingRecords:async(e,t)=>{if(!navigator.onLine)return;let r=s.loadAll(),n=r.filter(e=>e.pendingSync);for(let r of n){let{data:n,error:s}=await e.from(t).select("id").eq("id",r.id);if(!s&&(!n||0===n.length)){let{error:n}=await e.from(t).insert([{...r,pendingSync:void 0}]);n||(r.pendingSync=!1)}}let i=r.map(e=>n.find(t=>t.id===e.id)?{...e,pendingSync:!1}:e);localStorage.setItem("mathquiz_game_history",JSON.stringify(i))},loadAll:()=>{try{let e=localStorage.getItem("mathquiz_game_history");if(!e)return[];return JSON.parse(e).map(e=>({...e,completedAt:new Date(e.completedAt)}))}catch(e){return console.error("Failed to load game history:",e),[]}},mergeWithRemote:e=>{let t=s.loadAll(),r=[...e];for(let e of t)r.find(t=>t.id===e.id)||r.push(e);return r.map(e=>({...e,created_at:"string"==typeof e.created_at?e.created_at:e.completedAt instanceof Date?e.completedAt.toISOString():"string"==typeof e.completedAt?e.completedAt:new Date().toISOString()}))},clear:()=>{try{localStorage.removeItem("mathquiz_game_history")}catch(e){console.error("Failed to clear game history:",e)}}}},2745:(e,t,r)=>{r.d(t,{al:()=>s});var n=r(2115);let s=()=>{let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>{t(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}},3970:(e,t,r)=>{let n;r.d(t,{N:()=>n});var s=r(2354);try{let e="https://jtpzzbognaeitsffarcd.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0cHp6Ym9nbmFlaXRzZmZhcmNkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3ODUzMTQsImV4cCI6MjA3MDM2MTMxNH0.EKnCEKxKKLLs9iWkHdBHdyWeyrQsHa6IU02NTNGatao";if(!e||!t)throw Error("Supabase URL or Anon Key is missing. Check your environment variables.");n=(0,s.UU)(e,t),console.log("[Supabase] Client initialized:",e)}catch(e){console.error("[Supabase] Initialization error:",e)}},7488:(e,t,r)=>{r.d(t,{CG:()=>n,cZ:()=>i,uq:()=>s});let n={USERS:"game_players",RECORDS:"game_history",APPS:"game_apps"},s={MATH_QUIZ:"math_quiz",ID:"1a1e558c-2c2f-4dc0-9f92-991821a44e23"},i={USERS:{ID:"id",USERNAME:"username"},RECORDS:{ID:"id",PLAYER_ID:"player_id",SCORE:"score",ACHIEVEMENT:"achievement",GAME_DURATION:"game_duration",PLAYER_LEVEL:"player_level",GAME_SETTINGS:"game_settings"},GAME_APPS:{ID:"id",GAME_SETTINGS:"game_settings"}}},8258:(e,t,r)=>{r.d(t,{e:()=>d});var n=r(5453),s=r(1396),i=r(2056),a=r(3970),o=r(7488);async function c(e){console.log("[Supabase] createUser called with:",e);let{data:t,error:r}=await a.N.from(o.CG.USERS).insert([{username:e}]).select();if(r)throw console.error("[Supabase] createUser error:",r),r;return console.log("[Supabase] createUser response:",t),null==t?void 0:t[0]}async function l(e){console.log("[Supabase] getUserByUsername called with:",e);let{data:t,error:r}=await a.N.from(o.CG.USERS).select("*").eq(o.cZ.USERS.USERNAME,e);if(r)throw console.error("[Supabase] getUserByUsername error:",r),r;return console.log("[Supabase] getUserByUsername response:",t),t&&t.length>0?t[0]:null}async function u(e){let{player_id:t,game_id:r,score:n,achievement:s,game_duration:i,challenge_mode:c,player_level:l,game_settings:u}=e;console.log("[Supabase] createGameRecord called with:",{player_id:t,game_id:r,score:n,achievement:s,game_duration:i,challenge_mode:c,player_level:l,game_settings:u});let{data:m,error:d}=await a.N.from(o.CG.RECORDS).insert([{player_id:t,game_id:r,score:n,achievement:s,game_duration:i,challenge_mode:c,player_level:l,game_settings:u}]).select();if(d)throw console.error("[Supabase] createGameRecord error:",d),d;return console.log("[Supabase] createGameRecord response:",m),null==m?void 0:m[0]}let m={username:"",difficulty:"easy",numberOfQuestions:5,timerPerQuestion:10,questionType:"expression",mathOperations:["addition"],numberTypes:["integers"],timerEnabled:!0,questionsEnabled:!0,minCorrectAnswers:0,maxCorrectAnswers:5,correctAnswersEnabled:!1,minIncorrectAnswers:0,maxIncorrectAnswers:5,incorrectAnswersEnabled:!1,overallTimerEnabled:!1,overallTimerDuration:180,challengeMode:void 0},d=(0,n.v)((e,t)=>({_gameRecordSaved:!1,settings:m,questions:[],currentQuestionIndex:0,timeRemaining:m.timerPerQuestion,isQuizActive:!1,isQuizCompleted:!1,currentStreak:0,bestStreak:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:null,overallTimeRemaining:m.overallTimerDuration,overallTimerActive:!1,updateSettings:t=>{e(e=>({settings:{...e.settings,...t}}))},setQuestions:t=>{e({questions:t,currentQuestionIndex:0})},startQuiz:()=>{e(e=>({isQuizActive:!0,isQuizCompleted:!1,currentQuestionIndex:0,timeRemaining:e.settings.timerEnabled?e.settings.timerPerQuestion:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:Date.now(),overallTimeRemaining:e.settings.overallTimerEnabled?e.settings.overallTimerDuration:0,overallTimerActive:e.settings.overallTimerEnabled,_gameRecordSaved:!1}))},nextQuestion:()=>{e(e=>{let t=e.currentQuestionIndex+1,r=t>=e.questions.length,n=e.settings.correctAnswersEnabled&&e.correctAnswersCount>=e.settings.maxCorrectAnswers,s=e.settings.incorrectAnswersEnabled&&e.incorrectAnswersCount>=e.settings.maxIncorrectAnswers,i=r||n||s;return{currentQuestionIndex:t,timeRemaining:i?0:e.settings.timerEnabled?e.settings.timerPerQuestion:0,isQuizCompleted:i,isQuizActive:!i}})},submitAnswer:t=>{e(e=>{let r=[...e.questions],n=r[e.currentQuestionIndex];if(n){n.userAnswer=t,n.isCorrect=.01>Math.abs(n.answer-t),n.timeSpent=e.settings.timerEnabled?e.settings.timerPerQuestion-e.timeRemaining:0;let s=n.isCorrect?e.currentStreak+1:0,i=Math.max(e.bestStreak,s);return{questions:r,currentStreak:s,bestStreak:i,correctAnswersCount:n.isCorrect?e.correctAnswersCount+1:e.correctAnswersCount,incorrectAnswersCount:n.isCorrect?e.incorrectAnswersCount:e.incorrectAnswersCount+1}}return{questions:r}})},submitFractionAnswer:t=>{e(e=>{let r=[...e.questions],n=r[e.currentQuestionIndex];if(n){if(n.userFractionAnswer=t,n.fractionAnswer)n.isCorrect=(0,s.g3)(t,n.fractionAnswer);else{let e=(0,s.at)(t),r=e?Number(e.valueOf()):0;n.isCorrect=.01>Math.abs(n.answer-r)}n.timeSpent=e.settings.timerEnabled?e.settings.timerPerQuestion-e.timeRemaining:0;let i=n.isCorrect?e.currentStreak+1:0,a=Math.max(e.bestStreak,i);return{questions:r,currentStreak:i,bestStreak:a,correctAnswersCount:n.isCorrect?e.correctAnswersCount+1:e.correctAnswersCount,incorrectAnswersCount:n.isCorrect?e.incorrectAnswersCount:e.incorrectAnswersCount+1}}return{questions:r}})},submitCurrencyAnswer:t=>{e(e=>{let r=[...e.questions],n=r[e.currentQuestionIndex];if(n){let s=parseFloat(t.replace("$",""))||0;n.userAnswer=s,n.isCorrect=.01>Math.abs(n.answer-s),n.timeSpent=e.settings.timerEnabled?e.settings.timerPerQuestion-e.timeRemaining:0;let i=n.isCorrect?e.currentStreak+1:0,a=Math.max(e.bestStreak,i);return{questions:r,currentStreak:i,bestStreak:a,correctAnswersCount:n.isCorrect?e.correctAnswersCount+1:e.correctAnswersCount,incorrectAnswersCount:n.isCorrect?e.incorrectAnswersCount:e.incorrectAnswersCount+1}}return{questions:r}})},submitTimeAnswer:t=>{e(e=>{let r=[...e.questions],n=r[e.currentQuestionIndex];if(n){let s=t.split(":").map(Number),i=0;2===s.length&&(i=n.answer>3600?(60*s[0]+s[1])*60:60*s[0]+s[1]),n.userAnswer=i,n.isCorrect=1>Math.abs(n.answer-i),n.timeSpent=e.settings.timerEnabled?e.settings.timerPerQuestion-e.timeRemaining:0;let a=n.isCorrect?e.currentStreak+1:0,o=Math.max(e.bestStreak,a);return{questions:r,currentStreak:a,bestStreak:o,correctAnswersCount:n.isCorrect?e.correctAnswersCount+1:e.correctAnswersCount,incorrectAnswersCount:n.isCorrect?e.incorrectAnswersCount:e.incorrectAnswersCount+1}}return{questions:r}})},setTimeRemaining:t=>{e({timeRemaining:t})},setOverallTimeRemaining:t=>{e({overallTimeRemaining:t})},completeQuiz:async()=>{e({isQuizActive:!1,isQuizCompleted:!0,overallTimerActive:!1})},resetQuiz:()=>{e({questions:[],currentQuestionIndex:0,timeRemaining:t().settings.timerEnabled?t().settings.timerPerQuestion:0,isQuizActive:!1,isQuizCompleted:!1,currentStreak:0,bestStreak:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:null,overallTimeRemaining:t().settings.overallTimerDuration,overallTimerActive:!1})},retryQuiz:r=>{e({questions:r,currentQuestionIndex:0,timeRemaining:t().settings.timerEnabled?t().settings.timerPerQuestion:0,isQuizActive:!1,isQuizCompleted:!1,currentStreak:0,correctAnswersCount:0,incorrectAnswersCount:0,quizStartTime:null,overallTimeRemaining:t().settings.overallTimerDuration,overallTimerActive:!1,_gameRecordSaved:!1})},loadUserPreferences:()=>{let t=i.b.load();t&&e(e=>({settings:{...e.settings,...t.settings}}))},saveUserPreferences:()=>{let e=t(),r="";{let e=localStorage.getItem("math_quiz_user");if(e)try{r=JSON.parse(e).userId||""}catch(e){}}i.b.save({userId:r,userName:e.settings.username,settings:e.settings,lastUpdated:new Date})},saveGameResult:async()=>{let r=t();if(!r.isQuizCompleted||0===r.questions.length||t()._gameRecordSaved)return null;let n=r.questions.filter(e=>e.isCorrect).length,s=r.questions.length,a=Math.round(n/s*100),m=r.questions.reduce((e,t)=>e+(t.timeSpent||0),0),d=r.quizStartTime?Math.round((Date.now()-r.quizStartTime)/1e3):m,g="",S=r.settings.username;{let e=localStorage.getItem("math_quiz_user");if(e)try{let t=JSON.parse(e);g=t.userId||"",S=t.userName||S}catch(e){}}if(navigator.onLine&&S)try{let e=await l(S);e||(e=await c(S)),e&&e.id&&(g=e.id,localStorage.setItem("math_quiz_user",JSON.stringify({userId:g,userName:S}))),await u({player_id:g,game_id:o.uq.ID,score:a,achievement:"",challenge_mode:r.settings.challengeMode||"none",game_duration:d,player_level:r.settings.difficulty,game_settings:r.settings})}catch(e){console.error("Supabase save error:",e)}let w=i.O.save({settings:r.settings,questions:r.questions.map(e=>{var t;return{question:e.question,correctAnswer:e.fractionAnswer||e.answer.toString(),userAnswer:e.userFractionAnswer||(null==(t=e.userAnswer)?void 0:t.toString())||"",isCorrect:e.isCorrect||!1,timeSpent:e.timeSpent||0}}),totalQuestions:s,correctAnswers:n,incorrectAnswers:r.incorrectAnswersCount,score:a,timeSpent:m,quizDuration:d,averageTimePerQuestion:s>0?Math.round(m/s):0,created_at:new Date().toISOString()},!navigator.onLine);return e({_gameRecordSaved:!0}),w},clearUserData:()=>{i.b.clear(),i.O.clear(),e({settings:m,questions:[],currentQuestionIndex:0})}}))}}]);